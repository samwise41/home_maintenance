<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    
    <title>Home Maintenance Tracker</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a252f">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/1946/1946488.png">
    
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="top-bar">
    <div style="display: flex; align-items: center;">
        <button class="hamburger" onclick="window.toggleMenu()">‚ò∞</button>
        <div style="font-weight: bold; font-size: 1.2em;">üè† Home Tracker</div>
    </div>
</div>

<div class="main-layout">
    <div id="mobile-overlay" class="mobile-overlay" onclick="window.toggleMenu()"></div>

    <aside class="sidebar" id="sidebar">
        <button class="nav-tab active" onclick="window.switchTab('tab-dashboard', this)">Dashboard</button>
        <button class="nav-tab" onclick="window.switchTab('tab-timeline', this)">üìÖ By Due Date</button>
        <button class="nav-tab" onclick="window.switchTab('tab-category', this)">üìÅ By Category</button>
        <button class="nav-tab" onclick="window.switchTab('tab-lights', this)">üí° Lighting</button>
        <button class="nav-tab" onclick="window.switchTab('tab-all', this)">All Tasks</button>
        <button class="nav-tab" onclick="window.switchTab('tab-settings', this)">‚öôÔ∏è Utilities</button>
    </aside>

    <main class="content-area">
        <div id="status-message" style="margin-bottom: 15px; font-weight: bold; text-align: center;"></div>

        <div id="tab-dashboard" class="tab-content active"></div>
        <div id="tab-timeline" class="tab-content"></div>
        <div id="tab-category" class="tab-content"></div>
        <div id="tab-lights" class="tab-content"></div>
        <div id="tab-all" class="tab-content"></div>
        <div id="tab-settings" class="tab-content"></div>
    </main>
</div>

<div id="itemModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="window.closeModal('itemModal')">&times;</span>
        <h2 id="modalTitle">Add New Task</h2>
        <form id="itemForm">
            <input type="hidden" id="itemId">
            <label>Task Name:</label>
            <input type="text" id="itemName" required>
            <label>Location:</label>
            <select id="itemLocation" required></select>
            <label>Category:</label>
            <select id="itemCategory" required></select>
            <label>Frequency (Months):</label>
            <input type="number" id="itemFrequency" min="1" required>
            <div id="lastCompletedContainer">
                <label>Last Completed Date (Optional):</label>
                <input type="date" id="itemLastCompleted">
            </div>
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button type="submit" class="btn-primary" style="flex: 1;">Save Task</button>
                <button type="button" id="deleteBtn" class="btn-danger" style="display: none;" onclick="window.deleteItem()">üóëÔ∏è Delete</button>
            </div>
        </form>
    </div>
</div>

<div id="logModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="window.closeModal('logModal')">&times;</span>
        <h2>‚úÖ Log Maintenance</h2>
        <p id="logItemName" style="color: var(--text-light); font-weight: bold;"></p>
        <form id="logForm">
            <input type="hidden" id="logItemId">
            <label>Date Completed:</label>
            <input type="date" id="logDate" required>
            <label>Cost ($):</label>
            <input type="number" step="0.01" id="logCost" placeholder="0.00">
            <label>Notes (Optional):</label>
            <textarea id="logNotes"></textarea>
            <button type="submit" class="btn-primary" style="margin-top: 10px;">Mark Complete</button>
        </form>
    </div>
</div>

<div id="fixtureModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="window.closeModal('fixtureModal')">&times;</span>
        <h2 id="fixtureModalTitle">Add New Fixture</h2>
        <form id="fixtureForm">
            <input type="hidden" id="fixtureId">
            
            <label>Fixture Name (e.g., Vanity, Ceiling Fan):</label>
            <input type="text" id="fixtureName" required>
            
            <label>Location:</label>
            <select id="fixtureLocation" required></select>
            
            <div style="margin-top: 15px; border-top: 1px solid #ccc; padding-top: 10px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label>Bulbs in this fixture:</label>
                    <button type="button" class="btn-sm btn-outline" onclick="window.addBulbInput()">+ Add Bulb Slot</button>
                </div>
                <div id="bulbInputsContainer" style="margin-top: 10px; display: flex; flex-direction: column; gap: 8px;">
                    </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button type="submit" class="btn-primary" style="flex: 1;">Save Fixture</button>
                <button type="button" id="deleteFixtureBtn" class="btn-danger" style="display: none;" onclick="window.deleteFixture()">üóëÔ∏è Delete</button>
            </div>
        </form>
    </div>
</div>

<div id="bulbLogModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="window.closeModal('bulbLogModal')">&times;</span>
        <h2>üîå Replace Bulb</h2>
        <p id="bulbLogName" style="color: var(--text-light); font-weight: bold;"></p>
        <form id="bulbLogForm">
            <input type="hidden" id="bulbLogFixtureId">
            <input type="hidden" id="bulbLogBulbId">
            
            <label>Date Replaced:</label>
            <input type="date" id="bulbLogDate" required>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                <div>
                    <label>Brand:</label>
                    <input type="text" id="bulbLogBrand" placeholder="e.g., GE, Philips" required>
                </div>
                <div>
                    <label>Bulb Name/Type:</label>
                    <input type="text" id="bulbLogBulbName" placeholder="e.g., A19 LED, BR30" required>
                </div>
                <div>
                    <label>Wattage:</label>
                    <input type="text" id="bulbLogWattage" placeholder="e.g., 9W (60W eq)" required>
                </div>
                <div>
                    <label>Color:</label>
                    <input type="text" id="bulbLogColor" placeholder="e.g., Soft White (2700K)" required>
                </div>
                <div>
                    <label>Brightness (Lumens):</label>
                    <input type="text" id="bulbLogBrightness" placeholder="e.g., 800 Lumens" required>
                </div>
                <div>
                    <label>Warranty (Years):</label>
                    <input type="number" step="0.1" id="bulbLogWarranty" placeholder="e.g., 3, 5">
                </div>
            </div>
            
            <label style="margin-top: 10px;">Cost ($):</label>
            <input type="number" step="0.01" id="bulbLogCost" placeholder="0.00">
            
            <label>Notes (Optional):</label>
            <textarea id="bulbLogNotes"></textarea>
            
            <button type="submit" class="btn-primary" style="margin-top: 15px;">Log Replacement</button>
        </form>
    </div>
</div>

<script>
    var cacheBuster = '?v=' + new Date().getTime();
    document.write('<script src="js/app.js' + cacheBuster + '"><\/script>');
    document.write('<script src="js/tab-dashboard.js' + cacheBuster + '"><\/script>');
    document.write('<script src="js/tab-timeline.js' + cacheBuster + '"><\/script>');
    document.write('<script src="js/tab-category.js' + cacheBuster + '"><\/script>');
    document.write('<script src="js/tab-tasks.js' + cacheBuster + '"><\/script>');
    document.write('<script src="js/tab-lights.js' + cacheBuster + '"><\/script>');
    document.write('<script src="js/tab-settings.js' + cacheBuster + '"><\/script>');
</script>

<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('Service Worker registered!'))
                .catch(err => console.log('Service Worker failed:', err));
        });
    }
</script>
</body>
</html>
